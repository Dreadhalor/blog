"use strict";(self.webpackChunkthe_blog=self.webpackChunkthe_blog||[]).push([[6567],{8874:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var n=o(3274),i=o(9128);const r={},s="Sidebar File Browser",a={permalink:"/the-blog/blog/fallcrate-sidebar-browser",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/fallcrate-sidebar-browser/index.md",source:"@site/blog/fallcrate-sidebar-browser/index.md",title:"Sidebar File Browser",description:"We'll start this off by abstracting a new component for this right out of the gate.",date:"2024-04-14T12:42:47.000Z",tags:[],readingTime:8.625,hasTruncateMarker:!0,authors:[],frontMatter:{},unlisted:!1,prevItem:{title:"100 Days of Code 1: Birthday List",permalink:"/the-blog/blog/2024/04/15/birthday-list"},nextItem:{title:"fallcrate",permalink:"/the-blog/blog/fallcrate"}},c={authorsImageUrls:[]},l=[];function d(e){const t={a:"a",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"We'll start this off by abstracting a new component for this right out of the gate."}),"\n",(0,n.jsxs)(t.p,{children:["Let's create the new component at ",(0,n.jsx)(t.code,{children:"src/components/sidebar-file-browser/sidebar-file-browser.tsx"}),", since I'm expecting to have more dedicated components inside of that file browser & it would be nice to group them together."]}),"\n",(0,n.jsxs)(t.p,{children:["While we're at it, let's just group together the previous BrowseActionBar & BrowseActionBarButton files into ",(0,n.jsx)(t.code,{children:"src/components/browse-action-bar"})," as well."]}),"\n",(0,n.jsxs)(t.p,{children:["Okay, now let's put in some boilerplate with ",(0,n.jsx)(t.code,{children:"rafc"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-tsx",children:"// src/components/sidebar-file-browser/sidebar-file-browser.tsx\nimport React from 'react';\n\nexport const SidebarFileBrowser = () => {\n  return <div>SidebarFileBrowser</div>;\n};\n"})}),"\n",(0,n.jsxs)(t.p,{children:["& we'll import the new SidebarFileBrowser into the root page.tsx & make the sidebar div a ",(0,n.jsx)(t.code,{children:"flex-col"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-tsx",children:"// src/app/page.tsx\nimport { BrowseActionBar } from '@/components/browse-action-bar/browse-action-bar';\nimport { SidebarFileBrowser } from '@/components/sidebar-file-browser/sidebar-file-browser';\n\nconst Page = () => {\n  return (\n    <div className='flex h-full border-4 border-blue-600'>\n      <div className='flex w-[240px] flex-col border-4'>\n        SIDEBAR\n        <SidebarFileBrowser />\n      </div>\n      <div className='flex-1 flex-col border-4'>\n        <BrowseActionBar />\n        MAIN CONTENT\n      </div>\n    </div>\n  );\n};\n\nexport default Page;\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Perfect. Now additional code snippets can come from the SidebarFileBrowser file without needing to re-state too much code. Okay, now let's throw a border on it since we're in early dev & make it ",(0,n.jsx)(t.code,{children:"flex-1"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"Okay, with some styling here's where we're at. It's looking good:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-tsx",children:"// src/components/sidebar-file-browser/sidebar-file-browser.tsx\nimport React from 'react';\nimport { Button } from '@ui/button';\n\nexport const SidebarFileBrowser = () => {\n  return (\n    <div className='flex-1 border-2 border-blue-500'>\n      <Button className='w-full justify-start rounded-none bg-transparent px-[16px] py-[6px] text-white hover:bg-gray-800'>\n        All Files\n      </Button>\n    </div>\n  );\n};\n"})}),"\n",(0,n.jsxs)(t.p,{children:["I do notice, however that the button is technically the trigger to an accordion that shows/hides the file browser. So let's look back to shadcn/ui & add the ",(0,n.jsx)(t.code,{children:"Accordion"})," primitives."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"pnpm dlx shadcn-ui@latest add accordion"})}),"\n",(0,n.jsxs)(t.p,{children:["& with the component installed, now the move is to once again grab the simplest example on the documentation page, copy+paste the code, then modify it to suit our purposes. Here's the first example on the ",(0,n.jsx)(t.a,{href:"https://ui.shadcn.com/docs/components/accordion",children:"page for the accordion primitive:"})]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-tsx",children:"import {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from '@/components/ui/accordion';\n\nexport function AccordionDemo() {\n  return (\n    <Accordion type='single' collapsible className='w-full'>\n      <AccordionItem value='item-1'>\n        <AccordionTrigger>Is it accessible?</AccordionTrigger>\n        <AccordionContent>\n          Yes. It adheres to the WAI-ARIA design pattern.\n        </AccordionContent>\n      </AccordionItem>\n      <AccordionItem value='item-2'>\n        <AccordionTrigger>Is it styled?</AccordionTrigger>\n        <AccordionContent>\n          Yes. It comes with default styles that matches the other\n          components&apos; aesthetic.\n        </AccordionContent>\n      </AccordionItem>\n      <AccordionItem value='item-3'>\n        <AccordionTrigger>Is it animated?</AccordionTrigger>\n        <AccordionContent>\n          Yes. It's animated by default, but you can disable it if you prefer.\n        </AccordionContent>\n      </AccordionItem>\n    </Accordion>\n  );\n}\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Okay, now let's analyze. It looks like this ",(0,n.jsx)(t.code,{children:"Accordion"})," has multiple ",(0,n.jsx)(t.code,{children:"AccordionItem"})," elements, & we only need one. So let's change that & throw it right under our button to see how it looks."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-tsx",children:"// src/components/sidebar-file-browser/sidebar-file-browser.tsx\nimport React from 'react';\nimport { Button } from '@ui/button';\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from '@ui/accordion';\n\nexport const SidebarFileBrowser = () => {\n  return (\n    <div className='flex-1 border-2 border-blue-500'>\n      <Button className='w-full justify-start rounded-none bg-transparent px-[16px] py-[6px] text-white hover:bg-gray-800'>\n        All Files\n      </Button>\n      <Accordion type='single' collapsible className='w-full'>\n        <AccordionItem value='all-files'>\n          <AccordionTrigger>All Files</AccordionTrigger>\n          <AccordionContent>Woo, it is a content</AccordionContent>\n        </AccordionItem>\n      </Accordion>\n    </div>\n  );\n};\n"})}),"\n",(0,n.jsx)(t.p,{children:"Okay, the good news is it functions. The bad news is it doesn't look right. We can make some changes, but you may notice that we never actually specified anything about the caret. So it would appear that shadcn/ui both made the executive decision to put the caret on the right side of the trigger, as well as alternate only between facing up & facing down. We want this to look differently in 2 ways:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Put the caret on the left"}),"\n",(0,n.jsx)(t.li,{children:"Point the caret to the right when the folder is closed, & down when the folder is open."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"& also as a side note,"}),"\n",(0,n.jsxs)(t.ol,{start:"3",children:["\n",(0,n.jsx)(t.li,{children:"it looks weird that the text is underlined on hover. But that's much easier to fix, so we'll focus on fixing problems 1 & 2 for now."}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["So, since we didn't specify anything about the caret yet the caret exists & reacts to interaction, that means shadcn/ui simply made an opinionated decision about the caret. But since we know that it's built on Radix-ui, we can go under-the-hood & modify shadcn/ui's ",(0,n.jsx)(t.code,{children:"Accordion"})," with Radix-ui to behave more according to what we would like."]}),"\n",(0,n.jsx)(t.p,{children:"So, let's look at how shadcn/ui implements its accordion primitives:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-tsx",children:"// src/components/ui/accordion.tsx\n'use client';\n\nimport * as React from 'react';\nimport * as AccordionPrimitive from '@radix-ui/react-accordion';\nimport { ChevronDownIcon } from '@radix-ui/react-icons';\n\nimport { cn } from '@/lib/utils';\n\nconst Accordion = AccordionPrimitive.Root;\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn('border-b', className)}\n    {...props}\n  />\n));\nAccordionItem.displayName = 'AccordionItem';\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className='flex'>\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        'flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180',\n        className,\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDownIcon className='text-muted-foreground h-4 w-4 shrink-0 transition-transform duration-200' />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n));\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName;\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className='data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm'\n    {...props}\n  >\n    <div className={cn('pb-4 pt-0', className)}>{children}</div>\n  </AccordionPrimitive.Content>\n));\nAccordionContent.displayName = AccordionPrimitive.Content.displayName;\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent };\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Ah, it looks like the ",(0,n.jsx)(t.code,{children:"AccordionTrigger"})," component is what we should be zooming in on. Firstly, the ",(0,n.jsx)(t.code,{children:"ChevronDownIcon"})," is listed after the ",(0,n.jsx)(t.code,{children:"children"}),", which will put it to the right of the ",(0,n.jsx)(t.code,{children:"children"}),". Let's swap that around."]}),"\n",(0,n.jsxs)(t.p,{children:["Okay, that works. Now let's fix the spacing so that the trigger uses ",(0,n.jsx)(t.code,{children:"justify-start"})," instead of ",(0,n.jsx)(t.code,{children:"justify-between"})," to justify the children, because we don't want the children to be split on each end of the trigger."]}),"\n",(0,n.jsxs)(t.p,{children:["Great! Now let's handle the orientation of the ",(0,n.jsx)(t.code,{children:"ChevronDownIcon"}),". We can see that Tailwind is being used to rotate it based on the ",(0,n.jsx)(t.code,{children:"[&[data-state=open]>svg]"})," selector to target svgs inside of the trigger (with the ",(0,n.jsx)(t.code,{children:"ChevronDownIcon"})," being the only one). So, with that in mind, let's change the angle so that when the accordion is open, the ",(0,n.jsx)(t.code,{children:"ChevronDownIcon"})," is pointing down. Which, coincidentally, is the same thing as just not rotating it because the icon is already pointing down, hence it being ",(0,n.jsx)(t.code,{children:"ChevronDownIcon"}),". So what we're going to do to handle when the Accordion is closed, is to use the same selector but looking for ",(0,n.jsx)(t.code,{children:"data-state=closed"})," instead. We'll set the angle of rotation in that case to be -90 degrees, which in Tailwind syntax translates to ",(0,n.jsx)(t.code,{children:"-rotate-90"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["Okay, it's looking good! Let's just remove the ",(0,n.jsx)(t.code,{children:"hover:underline"})," class now because that looks weird."]}),"\n",(0,n.jsx)(t.p,{children:"Great! & now let's fix the padding, the hover color & the text color. I don't know why the caret is set to be a different color from the text, but let's fix that to make all the colors uniform. I also notice that the text is muted by default but turns white on hover, so let's add that."}),"\n",(0,n.jsx)(t.p,{children:'Great, now our "All Files" accordion trigger looks phenomenal. Here\'s what we got:'}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-tsx",children:"const AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className='flex'>\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        'text-muted-foreground flex flex-1 items-center justify-start gap-2 px-[16px] py-[6px] text-sm font-medium transition-all hover:bg-gray-800 hover:text-white [&[data-state=closed]>svg]:-rotate-90',\n        className,\n      )}\n      {...props}\n    >\n      <ChevronDownIcon className='h-4 w-4 shrink-0 transition-transform duration-200' />\n      {children}\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n));\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName;\n"})}),"\n",(0,n.jsx)(t.p,{children:"Okay, cool. Now we notice that every folder in the 'All Files' accordion is, itself, also an accordion. With slightly different styling. Hopefully that's not gonna be super annoying."}),"\n",(0,n.jsx)(t.p,{children:"To start with, let's just mock some data. We'll create an array of strings & treat that as the filenames of various folders. & just to make this easier to nest, we'll create a new component for this - SidebarFolder."}),"\n",(0,n.jsx)(t.p,{children:"Okay, looks like we'll have to fix some borders & bottom padding to nest these properly."}),"\n",(0,n.jsxs)(t.p,{children:["Alright, now it's looking pretty decent. We still need to indent each one, so we'll do that now. That is, unfortunately, one of the few issues with Tailwind. You can't use variable classnames. But we can wrap the children in a ",(0,n.jsx)(t.code,{children:"div"})," & style that div with inline CSS."]}),"\n",(0,n.jsxs)(t.p,{children:["...ah. So it looks like we have a problem. The padding is properly applied to the folder name, but not to the caret. We'll have to break up the ",(0,n.jsx)(t.code,{children:"AccordionTrigger"})," primitive a bit more if we want to wrap the caret inside of the div as well. It's a little inconvenient, but it's not actually a real problem when it comes down to it because we were gonna have to do that anyway if we wanted to add various visual flares such as the caret changing color on hover separately from the trigger, or for that matter if we want to separate the caret itself as a trigger & make the rest of the ",(0,n.jsx)(t.code,{children:"Accordion"})," header not be a trigger. So it was only a matter of time."]}),"\n",(0,n.jsxs)(t.p,{children:["Okay, great, it all works if I split out the Chevron into a separate component. I didn't actually split up the Accordion ",(0,n.jsx)(t.code,{children:"Trigger"})," & ",(0,n.jsx)(t.code,{children:"Header"})," primitives, but I don't think I care about that yet. Now let's just throw some icons in there to match Dropbox."]}),"\n",(0,n.jsxs)(t.p,{children:["That's actually hilarious. So it looks like because the icon is technically an SVG, now the folder icon rotates when the Accordian opens & closes. We can fix this by using some Tailwind ",(0,n.jsx)(t.code,{children:"group-"})," selectors, fortunately, so let's do that."]}),"\n",(0,n.jsx)(t.p,{children:"Great, it's all looking good! Now, Dropbox doesn't do this, but I don't like that empty folders still get Chevron icons. So let's replace the Chevron with a dot for folders that don't have child folders. We'll use the BsDot icon."}),"\n",(0,n.jsxs)(t.p,{children:["Looks awesome! There is some weirdness in that closing a folder closes all child folders too, & that seems unintuitive to me. Offhand, let's just see if we can fix that by making ",(0,n.jsx)(t.code,{children:"SidebarFolder"})," a controlled accordion."]}),"\n",(0,n.jsxs)(t.p,{children:["Ah, okay, so it looks like it's an issue with the ",(0,n.jsx)(t.code,{children:"AccordionContent"})," being unmounted on collapse & losing the internal state of whether or not it's open. Realistically I think the easiest way to solve this is by making them controlled accordions, & to do that in a scalable manner, that's going to require a provider. Which, technically, we may as well make since we actually don't have anything else to work on for this component. It will make it easier to mock data as well, since we can just mock it in the provider & then access it anywhere."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},9128:(e,t,o)=>{o.d(t,{R:()=>s,x:()=>a});var n=o(9474);const i={},r=n.createContext(i);function s(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);